import{a,j as e}from"./index-BBJX7inb.js";import{n as w,t as M}from"./chunk-WWGJGFF6-BoMxq1lg.js";import{u as O}from"./useApi-Dn3zf_yp.js";import{B as S}from"./Badge-Bgbs80Ll.js";import{B as m}from"./Button-B1BdtBaM.js";import{C as v,a as y,b as L}from"./Card-CFtCxk2z.js";import{L as z,I as _}from"./Label-JIDdilb1.js";import{M as P}from"./Modal-CHOY4886.js";import{P as q}from"./PageLayout-DTESgE-z.js";import{u as B}from"./ToastProvider-C_5kRdyY.js";import{c as b}from"./createLucideIcon-BrAVhkf1.js";import{P as H}from"./plus-BqUPOgIb.js";import"./session-BZ9GPMw7.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],I=b("building-2",D);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],A=b("external-link",$);function Z(){const u=w(),i=B(),{request:c,signedIn:r}=O(),[n,h]=a.useState(null),[o,x]=a.useState(null),[N,l]=a.useState(!1),[g,f]=a.useState(""),k=a.useMemo(()=>{var s;return n?`Welcome, ${(s=n.name)!=null&&s.trim()?n.name.trim():n.github_username??n.email}`:"Hurry Console"},[n]),d=a.useMemo(()=>o?[...o].sort((t,s)=>new Date(t.created_at).getTime()-new Date(s.created_at).getTime()):null,[o]),p=a.useCallback(async()=>{if(!r){h(null),x(null);return}try{const t=await c({path:"/api/v1/me"}),s=await c({path:"/api/v1/me/organizations"});h(t),x(s.organizations)}catch(t){if(t&&typeof t=="object"&&"status"in t&&t.status===401)return;h(null),x(null);const s=t&&typeof t=="object"&&"message"in t?String(t.message):"";i.push({kind:"error",title:"Failed to load",detail:s})}},[r,c,i]);async function j(){if(!r){i.push({kind:"error",title:"Sign in first"}),u("/auth");return}const t=g.trim();if(!t){i.push({kind:"error",title:"Organization name required"});return}try{const s=await c({path:"/api/v1/organizations",method:"POST",body:{name:t}});l(!1),f(""),await p(),u(`/org/${s.id}`)}catch(s){if(s&&typeof s=="object"&&"status"in s&&s.status===401)return;const C=s&&typeof s=="object"&&"message"in s?String(s.message):"";i.push({kind:"error",title:"Create failed",detail:C})}}return a.useEffect(()=>{p()},[p]),e.jsxs(q,{title:k,subtitle:"Manage organizations, invitations, API keys, and bot identities.",actions:e.jsxs(m,{onClick:()=>l(!0),disabled:!r,children:[e.jsx(H,{className:"h-4 w-4"}),"New org"]}),children:[r?null:e.jsx(v,{children:e.jsx(y,{children:e.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-content-primary",children:"Sign in required"}),e.jsx("div",{className:"mt-1 text-sm text-content-tertiary",children:"Paste a session token or use GitHub OAuth to continue."})]}),e.jsx(m,{onClick:()=>u("/auth"),children:"Sign in"})]})})}),e.jsxs(v,{children:[e.jsx(L,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-content-primary",children:"Organizations"}),e.jsx("div",{className:"text-xs text-content-muted",children:o?`${o.length} total`:r?"Loading…":"—"})]})}),e.jsxs(y,{children:[d&&d.length===0?e.jsx("div",{className:"text-sm text-content-tertiary",children:"No organizations yet. Create one to get started."}):null,d?e.jsx("div",{className:"space-y-3",children:d.map(t=>e.jsxs(M,{to:`/org/${t.id}`,className:"group flex items-center justify-between rounded-2xl border border-border bg-surface-subtle p-5 transition hover:border-border-accent-hover hover:bg-surface-subtle-hover",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{className:"h-5 w-5 text-accent-text"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold text-content-primary",children:t.name}),e.jsxs("div",{className:"mt-0.5 text-xs text-content-muted",children:["Created ",new Date(t.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{tone:t.role==="admin"?"neon":"muted",children:t.role}),e.jsx(A,{className:"h-4 w-4 text-content-muted transition group-hover:text-content-tertiary"})]})]},t.id))}):e.jsx("div",{className:"text-sm text-content-tertiary",children:r?"Loading…":"—"})]})]}),e.jsx(P,{open:N,title:"Create organization",onClose:()=>l(!1),onSubmit:j,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"orgName",children:"Name"}),e.jsx(_,{id:"orgName",value:g,onChange:t=>f(t.target.value),placeholder:"Acme Research"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(m,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(m,{onClick:j,children:"Create"})]})]})})]})}export{Z as default};
