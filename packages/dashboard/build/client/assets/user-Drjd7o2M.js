import{a as c,j as e}from"./index-BBJX7inb.js";import{n as k}from"./chunk-WWGJGFF6-BoMxq1lg.js";import{u as w}from"./useApi-Dn3zf_yp.js";import{B as r}from"./Button-B1BdtBaM.js";import{C as x,a as u,b as C}from"./Card-CFtCxk2z.js";import{L as S,I as M}from"./Label-JIDdilb1.js";import{M as _}from"./Modal-CHOY4886.js";import{P as L}from"./PageLayout-DTESgE-z.js";import{u as P}from"./ToastProvider-C_5kRdyY.js";import{c as h}from"./createLucideIcon-BrAVhkf1.js";import{G as A}from"./github-BjK37amk.js";import{P as E}from"./pencil-D3z8ZhFm.js";import"./session-BZ9GPMw7.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],q=h("calendar",H);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],O=h("log-out",I);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],U=h("mail",R);function Y(){const y=k(),i=P(),{request:o,logout:v,signedIn:n}=w(),[s,l]=c.useState(null),[N,m]=c.useState(!1),[p,j]=c.useState(""),d=c.useCallback(async()=>{if(!n){l(null);return}try{const t=await o({path:"/api/v1/me"});l(t)}catch(t){if(t&&typeof t=="object"&&"status"in t&&t.status===401)return;l(null);const a=t&&typeof t=="object"&&"message"in t?String(t.message):"";i.push({kind:"error",title:"Failed to load user",detail:a})}},[n,o,i]);function g(){j((s==null?void 0:s.name)??""),m(!0)}async function f(){if(!n)return;const t=p.trim();if(!t){i.push({kind:"error",title:"Name cannot be empty"});return}try{await o({path:"/api/v1/me",method:"PATCH",body:{name:t}}),i.push({kind:"success",title:"Account name updated"}),m(!1),await d()}catch(a){if(a&&typeof a=="object"&&"status"in a&&a.status===401)return;const b=a&&typeof a=="object"&&"message"in a?String(a.message):"";i.push({kind:"error",title:"Update failed",detail:b})}}return c.useEffect(()=>{d()},[d]),e.jsxs(L,{title:"Account",subtitle:"View your account information.",actions:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{variant:"secondary",onClick:g,disabled:!n||!s,children:[e.jsx(E,{className:"h-4 w-4"}),"Rename"]}),e.jsxs(r,{variant:"danger",onClick:v,disabled:!n,children:[e.jsx(O,{className:"h-4 w-4"}),"Sign out"]})]}),children:[n?null:e.jsx(x,{children:e.jsx(u,{children:e.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-content-primary",children:"Sign in required"}),e.jsx("div",{className:"mt-1 text-sm text-content-tertiary",children:"Sign in to view your profile information."})]}),e.jsx(r,{onClick:()=>y("/auth"),children:"Sign in"})]})})}),n&&s?e.jsxs(x,{children:[e.jsx(C,{children:e.jsx("div",{className:"text-sm font-semibold text-content-primary",children:"Account Details"})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-4",children:[s.name?e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 h-4 w-4 text-center text-accent-text text-xs font-bold",children:"N"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-content-muted",children:"Name"}),e.jsx("div",{className:"mt-0.5 text-sm text-content-primary",children:s.name})]})]}):null,e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(U,{className:"mt-0.5 h-4 w-4 text-accent-text"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-content-muted",children:"Email"}),e.jsx("div",{className:"mt-0.5 text-sm text-content-primary",children:s.email})]})]}),s.github_username?e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(A,{className:"mt-0.5 h-4 w-4 text-accent-text"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-content-muted",children:"GitHub Username"}),e.jsx("div",{className:"mt-0.5 text-sm text-content-primary",children:s.github_username})]})]}):null,e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(q,{className:"mt-0.5 h-4 w-4 text-accent-text"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-content-muted",children:"Member Since"}),e.jsx("div",{className:"mt-0.5 text-sm text-content-primary",children:new Date(s.created_at).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})})]})]})]})})]}):n?e.jsx(x,{children:e.jsx(u,{children:e.jsx("div",{className:"text-sm text-content-tertiary",children:"Loading..."})})}):null,e.jsx(_,{open:N,title:"Update account name",onClose:()=>m(!1),onSubmit:f,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"account-name",children:"Name"}),e.jsx(M,{id:"account-name",value:p,onChange:t=>j(t.target.value),placeholder:"Enter your name"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(r,{variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),e.jsx(r,{onClick:f,children:"Save"})]})]})})]})}export{Y as default};
